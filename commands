# Local GUI Testing
docker rm rel-25-gui
docker rmi rel-25-serverless:latest
docker build -t rel-25-serverless:latest .
docker run -d -p 8188:8188 --gpus all --name rel-25-gui rel-25-serverless:latest gui
# Push to Runpod
docker tag rel-25-serverless:latest latentagency/rel-25-serverless:latest
docker login
docker push latentagency/rel-25-serverless:latest
#
#
#
# Local Serverless Testing
docker rm rel-25-serverless
docker rmi rel-25-serverless:latest
docker build -t rel-25-serverless:latest .
docker run -d --gpus all --name rel-25-serverless rel-25-serverless:latest serverless
# Push to Runpod
docker tag rel-25-serverless:latest latentagency/rel-25-serverless:latest
docker login
docker push latentagency/rel-25-serverless:latest
#
#
#
# Test the endpoint (LA API KEY)
curl -X POST \
  -H "Authorization: Bearer rpa_L7Z6294LKIEFT0AUGIWJNTYY0BLH1SZDN6N7C3UT15gue4" \
  -H "Content-Type: application/json" \
  -d @test_input.json \
  https://api.runpod.ai/v2/62njtdljkuxiok/run


  curl -X POST \
  -H "Authorization: Bearer $RUNPOD_API_KEY" \
  -H "Content-Type: application/json" \
  -d @test_input.json \
  https://api.runpod.ai/v2/$ENDPOINT_ID/run
#
#
#
# Local GUI Testing and Push to RunPod
docker rm rel-25-gui                           # Remove old GUI container
docker rmi rel-25-serverless:latest            # Remove old image
docker build -t rel-25-serverless:latest .     # Build the new image
docker run -d -p 8188:8188 --gpus all --name rel-25-gui rel-25-serverless:latest gui  # Test GUI locally
docker stop rel-25-gui                         # Stop GUI container after testing
docker rm rel-25-gui                           # Clean up GUI container
docker tag rel-25-serverless:latest latentagency/rel-25-serverless:latest  # Tag for Docker Hub
docker push latentagency/rel-25-serverless:latest  # Push to Docker Hub





###### NEW
###### NEW
###### NEW


# 1. Build the Image
docker build -t rel-25-serverless:latest .

# 2. Run the Image Locally
# Serverless Mode (for testing)
docker run -d --gpus all --name rel-25-serverless rel-25-serverless:latest serverless

# GUI Mode (for local testing)
docker run -d -p 8188:8188 --gpus all --name rel-25-gui rel-25-serverless:latest gui

# 3. Stop a Running Container
# Stop serverless container
docker stop rel-25-serverless

# Stop GUI container
docker stop rel-25-gui

# 4. Remove a Stopped Container
# Remove serverless container
docker rm rel-25-serverless

# Remove GUI container
docker rm rel-25-gui

# 5. List Running Containers
docker ps

# 6. List All Containers (Including Stopped)
docker ps -a

# 7. View Container Logs
# Logs for serverless container
docker logs rel-25-serverless

# Logs for GUI container
docker logs rel-25-gui

# 8. Remove the Image
docker rmi rel-25-serverless:latest

# 9. Push to Docker Hub (for RunPod Deployment)
docker tag rel-25-serverless:latest yourusername/rel-25-serverless:latest
docker push yourusername/rel-25-serverless:latest

# 10. Clean Up Unused Images and Containers
# Remove stopped containers, networks, and dangling images
docker system prune

# Remove all unused images
docker image prune -a

# Deploying to RunPod Serverless
# (Note: These are run in a terminal, but deployment steps are manual in RunPod UI)
# Test the endpoint (after deployment)
curl -X POST \
  -H "Authorization: Bearer $RUNPOD_API_KEY" \
  -H "Content-Type: application/json" \
  -d @test_input.json \
  https://api.runpod.ai/v2/$ENDPOINT_ID/run

# Check job status
curl -X GET \
  -H "Authorization: Bearer $RUNPOD_API_KEY" \
  https://api.runpod.ai/v2/$ENDPOINT_ID/status/$JOB_ID

# Additional Commands for Development
# Enter a running container (debugging)
# For serverless container
docker exec -it rel-25-serverless bash

# For GUI container
docker exec -it rel-25-gui bash

# Build without cache (force rebuild)
docker build --no-cache -t rel-25-serverless:latest .

# Save image to a file
docker save -o rel-25-serverless.tar rel-25-serverless:latest

# Load image from a file
docker load -i rel-25-serverless.tar





###### OLD
###### OLD
###### OLD







# powershell commands

cd C:\Users\peter.schwarz\desktop\la
docker stop comfyui-container
docker rm comfyui-container
docker rmi comfyui-custom:latest
docker build -t comfyui-custom:latest .
echo '{"input": {"subject_description": "A modern chair", "background_image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="}}' | Out-File -Encoding UTF8 test_event.json
docker run --gpus all -v C:\Users\peter.schwarz\desktop\la:/comfyui/input -v C:\Users\peter.schwarz\desktop\la:/comfyui/output -e RUNPOD_EVENT="$(Get-Content test_event.json -Raw)" comfyui-custom:latest

# deploy to runpod 

cd C:\Users\peter.schwarz\desktop\la
docker stop comfyui-container
docker rm comfyui-container
docker rmi comfyui-custom:latest
docker build -t comfyui-custom:latest .

# deploy to runpod
docker run --gpus all -p 8188:8188 comfyui-custom:latest python main.py --listen 0.0.0.0
docker run --gpus all -p 8188:8188 comfyui-custom:latest python /comfyui/main.py --listen 0.0.0.0
docker tag comfyui-custom:latest latentagency/comfyui-custom:latest
docker login
docker push latentagency/comfyui-custom:latest

# build locally
cd "C:\Users\peter\Desktop\la"
docker stop comfyui-container 2>$null
docker rm comfyui-container 2>$null
docker rmi comfyui-custom:latest 2>$null
docker build -t comfyui-custom:latest .

# command to run locally
docker run --entrypoint python --gpus all -p 8188:8188 --name comfyui-container comfyui-custom:latest /comfyui/main.py --listen 0.0.0.0

# build & run locally

cd "C:\Users\peter\Desktop\la"
docker stop comfyui-container 2>$null
docker rm comfyui-container 2>$null
docker rmi comfyui-custom:latest 2>$null
docker build -t comfyui-custom:latest .
docker run --entrypoint python --gpus all -p 8188:8188 --name comfyui-container comfyui-custom:latest /comfyui/main.py --listen 0.0.0.0

# test endpoint

curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"input": {"subject_image": "/path/to/subject.png", "background_image": "/path/to/object.png", "x_coordinate": 50.0, "y_coordinate": 75.0, "z_coordinate": 0.5, "variation_intensity": 0.2, "product_consistency": 512, "background_consistency": 0.25, "seed": 123456789, "seed_mode": "fixed"}}' \
  https://your-runpod-endpoint-id.runpod.net/run

###

curl -X POST https://api.runpod.ai/v2/your-endpoint-id/run \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"input": {"subject_description": "A modern chair", "background_image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="}}'


# retrieve results

curl -X GET https://api.runpod.ai/v2/your-endpoint-id/status/YOUR_JOB_ID \
  -H "Authorization: Bearer YOUR_API_KEY"


# push to docker

docker login
docker push latentagency/comfyui-custom:latest
docker buildx build --platform linux/amd64 -t latentagency/comfyui-latetst --push .


# Navigate to your project directory
cd comfyui-runpod-worker

# Build the image
docker build -t latentagency/comfyui-worker:v1 .

# Log in to Docker Hub
docker login
# Enter username and password

# Push the image
docker push latentagency/comfyui-worker:v1

